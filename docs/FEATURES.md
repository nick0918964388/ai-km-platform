# 功能清單

AIKM Platform 完整功能說明

## 🤖 AI 問答系統

### 核心 RAG 功能

| 功能 | 說明 | 狀態 |
|------|------|------|
| 文字問答 | 基於知識庫的自然語言問答 | ✅ 已完成 |
| 多模態查詢 | 支援圖片 + 文字混合輸入 | ✅ 已完成 |
| 串流回應 | SSE 即時串流顯示回答 | ✅ 已完成 |
| 語義搜尋 | 基於向量相似度的文件檢索 | ✅ 已完成 |
| 重排序 | Cohere Rerank 提升結果相關性 | ✅ 已完成 |

### 🆕 最新優化功能

#### 📄 來源文件線上預覽
- **Modal 彈窗預覽** - 點擊來源文件即可在彈窗中預覽原始文件
- **PDF 內嵌顯示** - PDF 文件直接在瀏覽器中顯示，無需下載
- **頁碼定位** - 自動跳轉至引用的頁面位置
- **支援格式** - PDF、Word、Excel、圖片

#### 📊 相似度分數視覺化
- **分數顯示** - 每個來源文件顯示相關性分數 (0-1)
- **視覺化呈現** - 使用顏色標示相關程度
  - 🟢 綠色 (≥0.8) - 高度相關
  - 🟡 黃色 (0.5-0.8) - 中度相關
  - 🔴 紅色 (<0.5) - 低相關性
- **自動過濾** - 低於 0.5 分的來源不顯示

#### 💡 引導問題功能
- **自動生成** - AI 根據問答內容生成 3 個後續問題建議
- **一鍵發送** - 點擊建議問題自動填入輸入框
- **上下文相關** - 問題基於當前對話脈絡生成

#### 🗂️ 來源文件可收合顯示
- **預設收合** - 避免過多來源佔用畫面空間
- **展開/收合** - 點擊按鈕切換顯示狀態
- **數量標示** - 收合時顯示來源文件總數

---

## 📁 文件管理

### 文件上傳

| 格式 | 支援 | 特殊處理 |
|------|------|----------|
| PDF | ✅ | 頁面切分、圖片提取、OCR |
| Word (.docx) | ✅ | 段落保留、表格解析 |
| Excel (.xlsx/.xls) | ✅ | 工作表處理、資料列轉換 |
| 圖片 | ✅ | CLIP 嵌入、OCR 文字提取 |

### 文件處理

- **智慧分塊** - 遞歸文字切分，保留語意完整性
- **Chunk 大小** - 500 tokens，50 tokens 重疊
- **元資料保留** - 檔名、頁碼、上傳時間
- **原檔儲存** - 保留原始文件供預覽

### 文件管理

- **清單顯示** - 檢視所有已上傳文件
- **統計資訊** - 文件數量、區塊數、儲存空間
- **刪除文件** - 移除文件及相關向量

---

## 🔍 結構化資料查詢

### 自然語言轉 SQL

- **智慧意圖分類** - 自動識別查詢類型
- **NL2SQL 轉換** - 自然語言轉換為 SQL 查詢
- **安全執行** - 僅允許 SELECT 語句

### 資料領域

| 領域 | 表格 | 查詢範例 |
|------|------|----------|
| 車輛管理 | vehicles | 查詢所有運營中的車輛 |
| 故障記錄 | fault_records | EMU801 故障歷程 |
| 維修記錄 | maintenance_records | 上個月維修統計 |
| 成本記錄 | cost_records | 年度維修成本分析 |
| 零件庫存 | parts_inventory | 低庫存零件清單 |

### 查詢路由

```
用戶查詢
    ↓
意圖分類器
    ↓
┌───────────────────────────┐
│   structured → SQL 查詢   │
│   knowledge → RAG 搜尋    │
│   hybrid → 兩者結合       │
│   clarification → 追問    │
└───────────────────────────┘
```

---

## 📊 儀表板

### 統計卡片

- 總文件數
- 總區塊數
- 今日查詢數
- 系統健康狀態

### 趨勢圖表

- 查詢量趨勢
- 文件上傳趨勢
- 回應時間統計

### 警報通知

- 低庫存提醒
- 系統異常通知
- 待處理項目

---

## 🔧 系統功能

### 備份與還原

- **手動備份** - 建立向量資料庫快照
- **自動備份** - 排程定期備份
- **備份還原** - 從快照恢復資料
- **備份下載** - 下載備份檔案

### 快取管理

- **Redis 快取** - 查詢結果快取
- **嵌入快取** - 向量嵌入快取
- **快取統計** - 命中率、大小
- **快取清除** - 手動清除過期快取

### 評測功能

- **RAGAS 評測** - 標準 RAG 評測指標
  - Context Recall
  - Faithfulness
  - Factual Correctness
- **自訂測試集** - 上傳測試資料
- **評測報告** - 詳細分數報告

---

## 🎨 使用者介面

### 聊天介面

- **訊息氣泡** - 清晰的對話呈現
- **Markdown 渲染** - 支援格式化文字
- **程式碼高亮** - 程式碼區塊語法高亮
- **複製功能** - 一鍵複製回答

### 響應式設計

- **桌面版** - 側邊欄導航
- **平板版** - 可收合側邊欄
- **手機版** - 底部導航、全螢幕聊天

### 設計系統

- **IBM Carbon Design** - 企業級 UI 元件
- **Tailwind CSS v4** - 原子化樣式
- **深色主題** - 支援深色模式

---

## 🔐 安全與認證

### API 安全

- **API Key 認證** - Header 驗證
- **CORS 限制** - 來源白名單
- **請求限流** - 防止濫用

### 使用者認證 (規劃中)

- NextAuth.js 整合
- SSO 支援
- 角色權限控制

---

## 📱 語音功能 (實驗性)

### 語音輸入

- **VAD 語音活動偵測** - 自動開始/結束錄音
- **語音轉文字** - 即時轉錄
- **按鈕控制** - 手動開始/停止

---

## 🛣️ 未來規劃

### 短期 (Q1 2024)

- [ ] 使用者認證系統
- [ ] 對話歷史持久化
- [ ] 多知識庫支援

### 中期 (Q2 2024)

- [ ] 文件版本控制
- [ ] 協作功能
- [ ] API 使用量統計

### 長期

- [ ] 私有 LLM 支援
- [ ] 多語言支援
- [ ] 插件系統
